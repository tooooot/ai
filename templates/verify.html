<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <title>Ù…Ø±ÙƒØ² Ø§Ù„Ù…ØµØ¯Ø§Ù‚ÙŠØ© ÙˆØ§Ù„ØªØ­Ù‚Ù‚</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <style>
        .verify-card {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid var(--accent-green);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
        }

        .status-dot {
            height: 10px;
            width: 10px;
            background-color: var(--accent-green);
            border-radius: 50%;
            display: inline-block;
            box-shadow: 0 0 10px var(--accent-green);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th,
        td {
            text-align: right;
            padding: 10px;
            border-bottom: 1px solid #333;
        }

        th {
            color: #888;
        }

        a {
            color: var(--accent-gold);
            text-decoration: none;
            border-bottom: 1px dotted;
        }

        .quote {
            font-style: italic;
            color: #aaa;
            border-right: 3px solid var(--accent-gold);
            padding-right: 10px;
        }
    </style>
</head>

<body>
    <div style="max-width: 800px; margin: 0 auto; padding: 20px;">
        <h1 style="text-align: center;">ğŸ›¡ï¸ Ù…Ø±ÙƒØ² Ø§Ù„Ù…ØµØ¯Ø§Ù‚ÙŠØ© ÙˆØ§Ù„ØªØ­Ù‚Ù‚</h1>
        <p style="text-align: center; color: #888;">"Ù„Ø§ ØªØ«Ù‚ØŒ Ø¨Ù„ ØªØ­Ù‚Ù‚" - Don't Trust, Verify</p>

        <!-- System Status -->
        <div class="verify-card">
            <h2>ğŸ¥ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
            <div style="display: flex; justify-content: space-between;">
                <div>Ø§Ù„ÙˆÙ‚Øª Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…: <span id="server-time" class="mono">...</span></div>
                <div>Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„: <span style="color:var(--accent-green)">Ù…ØªØµÙ„ <span class="status-dot"></span></span>
                </div>
            </div>
        </div>

        <!-- Price Verification -->
        <div class="verify-card">
            <h2>ğŸ“ˆ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø³Ø¹Ø§Ø± (Live Check)</h2>
            <p>Ù†Ù‚ÙˆÙ… Ø¨Ù…Ù‚Ø§Ø±Ù†Ø© Ø³Ø¹Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù…Ø¹ Ù…ÙˆÙ‚Ø¹ ØªØ¯Ø§ÙˆÙ„ Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¯Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</p>
            <div id="price-check">
                Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...
            </div>
        </div>

        <!-- News Archive -->
        <div>
            <h2>ğŸ“° Ø£Ø±Ø´ÙŠÙ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø®Ø¨Ø§Ø± (News Proof)</h2>
            <p style="font-size: 0.9rem; color: #888;">Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¬Ù„ ÙŠØ«Ø¨Øª Ø£Ù† Ù‚Ø±Ø§Ø±Ø§Øª "Ø¹ÙˆØ§Ø·Ù" Ù…Ø¨Ù†ÙŠØ© Ø¹Ù„Ù‰ Ø£Ø®Ø¨Ø§Ø± Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙˆÙ„ÙŠØ³
                Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©.</p>
            <table id="news-table">
                <thead>
                    <tr>
                        <th>Ø§Ù„ØªÙˆÙ‚ÙŠØª</th>
                        <th>Ø§Ù„Ù…ØµØ¯Ø±</th>
                        <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                        <th>ØªØ­Ù„ÙŠÙ„Ù†Ø§</th>
                    </tr>
                </thead>
                <tbody id="news-body">
                    <!-- Populated by JS -->
                </tbody>
            </table>
        </div>

        <div style="text-align:center; margin-top: 40px;">
            <a href="/app" style="font-size: 1.2rem;">ğŸ“± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚</a>
        </div>
    </div>

    <script>
        async function loadVerification() {
            // 1. Load Metadata
            const metaRes = await fetch('/api/verify_data');
            const meta = await metaRes.json();

            document.getElementById('server-time').innerText = meta.server_time;

            const p = meta.sample_price;
            document.getElementById('price-check').innerHTML = `
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <div style="font-size:1.5rem;">${p.symbol}: <span class="mono">${p.price}</span> Ø±ÙŠØ§Ù„</div>
                    <a href="${p.source_link}" target="_blank">ğŸ”— Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© ÙÙŠ Ù…ÙˆÙ‚Ø¹ ØªØ¯Ø§ÙˆÙ„</a>
                </div>
            `;

            // 2. Load News Archive
            const newsRes = await fetch('/api/news_archive');
            const news = await newsRes.json();

            const tbody = document.getElementById('news-body');
            tbody.innerHTML = news.map(n => `
                <tr>
                    <td class="mono" style="font-size:0.8rem;">${n.timestamp}</td>
                    <td><a href="${n.source_url}" target="_blank">${n.source}</a></td>
                    <td>${n.title}</td>
                    <td style="color:${n.score > 0 ? 'var(--accent-green)' : (n.score < 0 ? 'var(--accent-red)' : '#888')}">
                        ${n.sentiment}
                    </td>
                </tr>
            `).join('');
        }

        loadVerification();
        setInterval(loadVerification, 10000);
    </script>
</body>

</html>