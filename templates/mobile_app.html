<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Private Wealth</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body class="bank-theme app-mode">

    <!-- App Container -->
    <div class="app-container">

        <!-- ================== VIEW 1: ONBOARDING ================== -->
        <div id="view-onboarding" class="view-section active">
            <div class="onboarding-slide">
                <div class="slide-icon">ğŸ§  ğŸ†š ğŸ¤–</div>
                <h1 class="main-title">Ù„Ù…Ø§Ø°Ø§ ØªØ®Ø³Ø± ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ØŸ</h1>
                <p style="color:var(--text-secondary); line-height:1.6;">
                    Ø§Ù„Ø¥Ù†Ø³Ø§Ù† ÙŠØªØ±Ø¯Ø¯ØŒ ÙŠØ®Ø§ÙØŒ ÙˆÙŠØªØ¹Ø¨.<br>
                    Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ Ù„Ø§ ØªØ±Ø­Ù… Ø§Ù„Ø¹ÙˆØ§Ø·Ù.
                </p>

                <div class="contrast-box">
                    <div class="vs-item vs-brain">
                        <i data-lucide="frown" style="margin-bottom:5px;"></i><br>
                        Ù‚Ø±Ø§Ø±Ø§Øª Ø¹Ø§Ø·ÙÙŠØ©
                    </div>
                    <div style="font-weight:bold; color:#555;">VS</div>
                    <div class="vs-item vs-bot">
                        <i data-lucide="cpu" style="margin-bottom:5px;"></i><br>
                        Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§ÙÙŠØ©
                    </div>
                </div>

                <div class="contrast-box">
                    <div class="vs-item vs-brain">
                        <i data-lucide="clock" style="margin-bottom:5px;"></i><br>
                        Ù†ÙˆÙ… ÙˆØ±Ø§Ø­Ø©
                    </div>
                    <div style="font-weight:bold; color:#555;">VS</div>
                    <div class="vs-item vs-bot">
                        <i data-lucide="zap" style="margin-bottom:5px;"></i><br>
                        24/7 Ø§Ù‚ØªÙ†Ø§Øµ
                    </div>
                </div>

                <button class="bank-btn" onclick="switchView('marketplace')" style="width:100%; margin-top:20px;">
                    Ø§ÙƒØªØ´Ù Ø§Ù„Ø±ÙˆØ¨ÙˆØªØ§Øª ğŸš€
                </button>
            </div>
        </div>

        <!-- ================== VIEW 2: MARKETPLACE ================== -->
        <div id="view-marketplace" class="view-section">
            <header class="app-header" style="background:transparent;">
                <h2 style="color:white; margin:0;">Ø§Ø®ØªØ± Ø¹Ù‚Ù„Ùƒ Ø§Ù„Ø°ÙƒÙŠ</h2>
                <button class="icon-btn" onclick="switchView('onboarding')">â†©ï¸</button>
            </header>

            <div class="market-grid">
                <!-- Bot 1: Sayyad -->
                <div class="bot-card-pro featured">
                    <div class="bot-card-header">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <div class="avatar" style="background:var(--accent-gold); color:black;">Øµ</div>
                            <div>
                                <div style="font-weight:bold; color:white;">Ø±ÙŠØ¨ÙˆØª ØµÙŠØ§Ø¯</div>
                                <div style="font-size:0.7rem; color:var(--accent-gold);">Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ø¹Ø¨ÙŠØ©</div>
                            </div>
                        </div>
                        <div style="text-align:center;">
                            <div style="font-weight:900; color:var(--accent-green); font-size:1.2rem;">+13%</div>
                            <div style="font-size:0.6rem; color:#888;">Ø¹Ø§Ø¦Ø¯ Ø´Ù‡Ø±ÙŠ</div>
                        </div>
                    </div>
                    <p style="font-size:0.8rem; color:#ccc; margin-bottom:15px;">
                        Ù…ØªØ®ØµØµ ÙÙŠ Ø§Ù‚ØªÙ†Ø§Øµ Ø§Ù„ÙØ±Øµ Ø§Ù„Ø³Ø±ÙŠØ¹Ø© ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ. ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù„Ø­Ø¸ÙŠ.
                    </p>
                    <button class="subscribe-btn" onclick="showBotDetails('ØµÙŠØ§Ø¯', 13)">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ (Ù„Ù„Ù…Ù‚ØªÙ†Ø¹ÙŠÙ† ÙÙ‚Ø·)
                        ğŸ“Š</button>
                </div>

                <!-- Bot 2: Razin -->
                <div class="bot-card-pro">
                    <div class="bot-card-header">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <div class="avatar" style="background:#3b82f6; color:white;">Ø±</div>
                            <div>
                                <div style="font-weight:bold; color:white;">Ø±ÙŠØ¨ÙˆØª Ø±Ø²ÙŠÙ†</div>
                                <div style="font-size:0.7rem; color:#3b82f6;">Ù…Ø®Ø§Ø·Ø±Ø© Ù…Ù†Ø®ÙØ¶Ø©</div>
                            </div>
                        </div>
                        <div style="text-align:center;">
                            <div style="font-weight:900; color:var(--accent-green); font-size:1.2rem;">+5%</div>
                            <div style="font-size:0.6rem; color:#888;">Ø¹Ø§Ø¦Ø¯ Ø´Ù‡Ø±ÙŠ</div>
                        </div>
                    </div>
                    <p style="font-size:0.8rem; color:#ccc; margin-bottom:15px;">
                        ÙŠØ³ØªÙ‡Ø¯Ù Ø§Ù„Ø£Ø³Ù‡Ù… Ø§Ù„Ù‚ÙŠØ§Ø¯ÙŠØ© Ø°Ø§Øª Ø§Ù„Ø¹ÙˆØ§Ø¦Ø¯ Ø§Ù„Ù…Ø³ØªÙ‚Ø±Ø©. Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ø·ÙˆÙŠÙ„ Ø§Ù„Ø£Ø¬Ù„.
                    </p>
                    <button class="subscribe-btn" style="background:#334155; color:white;"
                        onclick="showBotDetails('Ø±Ø²ÙŠÙ†', 5)">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ ğŸ“Š</button>
                </div>

                <!-- Bot 3: Meqdam -->
                <div class="bot-card-pro">
                    <div class="bot-card-header">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <div class="avatar" style="background:#ef4444; color:white;">Ù…</div>
                            <div>
                                <div style="font-weight:bold; color:white;">Ø±ÙŠØ¨ÙˆØª Ù…Ù‚Ø¯Ø§Ù…</div>
                                <div style="font-size:0.7rem; color:#ef4444;">Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù…Ø®Ø§Ø·Ø±</div>
                            </div>
                        </div>
                        <div style="text-align:center;">
                            <div style="font-weight:900; color:var(--accent-green); font-size:1.2rem;">+22%</div>
                            <div style="font-size:0.6rem; color:#888;">Ø¹Ø§Ø¦Ø¯ Ø´Ù‡Ø±ÙŠ</div>
                        </div>
                    </div>
                    <p style="font-size:0.8rem; color:#ccc; margin-bottom:15px;">
                        Ø¬Ø³ÙˆØ±ØŒ Ù„Ø§ ÙŠØ®Ø´Ù‰ Ø§Ù„ØªÙ‚Ù„Ø¨Ø§Øª. ÙŠØ¯Ø®Ù„ ÙÙŠ ØµÙÙ‚Ø§Øª Ø°Ø§Øª Ø¹ÙˆØ§Ø¦Ø¯ Ø¹Ø§Ù„ÙŠØ© ÙˆÙ…Ø®Ø§Ø·Ø±Ø© Ù…Ø¯Ø±ÙˆØ³Ø©.
                    </p>
                    <button class="subscribe-btn" style="background:#334155; color:white;"
                        onclick="showBotDetails('Ù…Ù‚Ø¯Ø§Ù…', 22)">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ ğŸ“Š</button>
                </div>

                <!-- Bot 4: Qanas (Sniper) -->
                <div class="bot-card-pro">
                    <div class="bot-card-header">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <div class="avatar" style="background:#a855f7; color:white;">Ù‚</div>
                            <div>
                                <div style="font-weight:bold; color:white;">Ø±ÙŠØ¨ÙˆØª Ù‚Ù†Ø§Øµ</div>
                                <div style="font-size:0.7rem; color:#a855f7;">Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ©</div>
                            </div>
                        </div>
                        <div style="text-align:center;">
                            <div style="font-weight:900; color:var(--accent-green); font-size:1.2rem;">+18%</div>
                            <div style="font-size:0.6rem; color:#888;">Ø¹Ø§Ø¦Ø¯ Ø´Ù‡Ø±ÙŠ</div>
                        </div>
                    </div>
                    <p style="font-size:0.8rem; color:#ccc; margin-bottom:15px;">
                        ÙŠÙ†ØªØ¸Ø± Ø§Ù„ÙØ±ØµØ© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© Ø¨ØµØ¨Ø± Ø·ÙˆÙŠÙ„. Ù…Ø¹Ø¯Ù„ ØµÙÙ‚Ø§Øª Ù‚Ù„ÙŠÙ„ ÙˆÙ„ÙƒÙ† Ù‡Ø§Ù…Ø´ Ø±Ø¨Ø­ Ù…Ø±ØªÙØ¹.
                    </p>
                    <button class="subscribe-btn" style="background:#334155; color:white;"
                        onclick="showBotDetails('Ù‚Ù†Ø§Øµ', 18)">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ ğŸ“Š</button>
                </div>

                <!-- Bot 5: Awatif (AI Assistant) -->
                <div class="bot-card-pro">
                    <div class="bot-card-header">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <div class="avatar" style="background:#ec4899; color:white;">Ø¹</div>
                            <div>
                                <div style="font-weight:bold; color:white;">Ù…Ø³Ø§Ø¹Ø¯ Ø¹ÙˆØ§Ø·Ù</div>
                                <div style="font-size:0.7rem; color:#ec4899;">Ù…Ø³Ø§Ø¹Ø¯ Ø´Ø®ØµÙŠ</div>
                            </div>
                        </div>
                        <div style="text-align:center;">
                            <div style="font-weight:900; color:var(--accent-green); font-size:1.2rem;">--</div>
                        </div>
                    </div>
                    <p style="font-size:0.8rem; color:#ccc; margin-bottom:15px;">
                        Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø´Ø®ØµÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙˆØ§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù† Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙƒ Ø­ÙˆÙ„ Ø§Ù„Ø³ÙˆÙ‚.
                    </p>
                    <button class="subscribe-btn" style="background:#334155; color:white;"
                        onclick="showBotDetails('Ø¹ÙˆØ§Ø·Ù', 0)">ØªØ­Ø¯Ø« Ø§Ù„Ø¢Ù† ğŸ’¬</button>
                </div>

            </div>
        </div>

        <!-- ================== VIEW 2.5: BOT DETAILS (CONVICTION) ================== -->
        <div id="view-bot-detail" class="view-section" style="padding-bottom:100px;">
            <header class="app-header">
                <button class="icon-btn" onclick="switchView('marketplace')">â†©ï¸ Ø¹ÙˆØ¯Ø©</button>
                <h3 style="margin:0; font-size:1rem;">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡</h3>
                <div style="width:30px;"></div>
            </header>

            <div class="detail-header">
                <div class="avatar" id="detail-avatar"
                    style="width:60px; height:60px; font-size:1.5rem; margin:0 auto;"></div>
                <h2 id="detail-name" style="margin:10px 0 5px;">--</h2>
                <div class="detail-stat-big" id="detail-return">--%</div>
                <p style="color:#888; font-size:0.8rem;">Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„ØªØ±Ø§ÙƒÙ…ÙŠ Ù…Ù†Ø° Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¹Ø§Ù…</p>
            </div>

            <div class="section-header">
                <h3>ğŸ“ˆ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ (Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø§Ù„Ø³ÙˆÙ‚)</h3>
            </div>
            <div class="chart-container">
                <!-- Mock Bars -->
                <div class="chart-bar-group">
                    <div class="chart-bar win" style="height:40%;"></div><span class="chart-label">Ø£Ø³Ø¨ÙˆØ¹ 1</span>
                </div>
                <div class="chart-bar-group">
                    <div class="chart-bar win" style="height:60%;"></div><span class="chart-label">Ø£Ø³Ø¨ÙˆØ¹ 2</span>
                </div>
                <div class="chart-bar-group">
                    <div class="chart-bar loss" style="height:20%;"></div><span class="chart-label">Ø£Ø³Ø¨ÙˆØ¹ 3</span>
                </div>
                <div class="chart-bar-group">
                    <div class="chart-bar win" style="height:80%;"></div><span class="chart-label">Ø£Ø³Ø¨ÙˆØ¹ 4</span>
                </div>
                <div class="chart-bar-group">
                    <div class="chart-bar win" style="height:90%;"></div><span class="chart-label">Ø§Ù„Ø­Ø§Ù„ÙŠ</span>
                </div>
            </div>

            <div class="section-header">
                <h3>ğŸ§  ÙƒÙŠÙ Ø£ÙÙƒØ±ØŸ (Ø§Ù„Ù…ØµØ§Ø¯Ø±)</h3>
            </div>
            <div class="source-grid">
                <div class="source-item"><i data-lucide="newspaper"></i><br>Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø³ÙˆÙ‚</div>
                <div class="source-item"><i data-lucide="bar-chart-2"></i><br>Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙÙ†ÙŠ</div>
                <div class="source-item"><i data-lucide="globe"></i><br>Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©</div>
                <div class="source-item"><i data-lucide="users"></i><br>Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ù„Ø§Ùƒ</div>
                <div class="source-item"><i data-lucide="zap"></i><br>Ø§Ù„Ø³ÙŠÙˆÙ„Ø© Ø§Ù„Ù„Ø­Ø¸ÙŠØ©</div>
                <div class="source-item"><i data-lucide="shield"></i><br>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±</div>
            </div>

            <div class="section-header">
                <h3>ğŸ“œ Ø³Ø¬Ù„ Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ù…Ø§Ø¶ÙŠ</h3>
            </div>
            <div class="proof-section" id="proof-list">
                <!-- Injected via JS -->
            </div>

            <div class="sticky-action">
                <button class="bank-btn" style="width:100%; box-shadow:0 0 20px rgba(251, 191, 36, 0.4);"
                    onclick="confirmSubscribe()">
                    Ø§Ù‚ØªÙ†Ø¹Øª âœ… (Ø§Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø©)
                </button>
            </div>
        </div>

        <!-- ================== VIEW 3: DASHBOARD ================== -->
        <div id="view-dashboard" class="view-section">

            <div id="insight-container"></div>

            <header class="app-header">
                <div class="user-info">
                    <div class="avatar" id="dash-avatar">AI</div>
                    <div>
                        <span class="greeting">Ù…Ø­ÙØ¸Ø© Ù†Ø´Ø·Ø©</span>
                        <span class="status" id="dash-status">Ù…ØªØµÙ„ Ø¨Ù€ --</span>
                    </div>
                </div>
                <div style="display:flex; gap:10px;">
                    <button class="icon-btn" id="explain-toggle" onclick="toggleExplain()"
                        style="color:var(--text-muted);">
                        <i data-lucide="lightbulb"></i>
                    </button>
                    <button class="icon-btn" onclick="window.location.href='/verify'">ğŸ›¡ï¸</button>
                </div>
            </header>

            <div class="balance-card">
                <div class="label">ØµØ§ÙÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ØµÙˆÙ„</div>
                <div class="amount" id="cash-display">10,000 SAR</div>
                <div class="change positive">
                    <i data-lucide="activity"></i>
                    <span>ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù† ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚...</span>
                </div>
            </div>

            <div class="section-header">
                <h3>ğŸ“œ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„Ø­ÙŠØ©</h3>
                <span class="status" style="font-size:0.7rem;">ØªØ­Ø¯ÙŠØ« Ù„Ø­Ø¸ÙŠ</span>
            </div>

            <div class="feed-wrapper" style="margin: 0 20px 80px; height:auto; min-height:400px; padding-bottom:100px;">
                <div class="transactions-list" id="content-area">
                </div>
            </div>

            <button class="fab-chat" onclick="openChat()">
                <i data-lucide="mic"></i>
                <span>Ø§Ø³Ø£Ù„ Ø§Ù„Ø±ÙˆØ¨ÙˆØª</span>
            </button>
        </div>

    </div>

    <!-- Chat Overlay -->
    <div id="chat-modal"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:9999; flex-direction:column; justify-content:flex-end;">
        <div
            style="background:var(--bg-card); height:85%; width:100%; border-radius:20px 20px 0 0; display:flex; flex-direction:column; max-width:480px; margin:0 auto;">
            <div
                style="padding:20px; border-bottom:1px solid #333; display:flex; justify-content:space-between; align-items:center;">
                <h3 style="margin:0; color:white;">Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</h3>
                <button onclick="document.getElementById('chat-modal').style.display='none'"
                    style="background:none; border:none; color:white; font-size:1.5rem;">&times;</button>
            </div>
            <div id="chat-history" style="flex:1; overflow-y:auto; padding:20px;"></div>
            <div style="padding:20px; border-top:1px solid #333; display:flex; gap:10px;">
                <input type="text" id="chat-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ..."
                    style="flex:1; padding:12px; border-radius:10px; border:none; background:#0f172a; color:white;">
                <button onclick="sendMessage()"
                    style="background:var(--accent-green); color:black; border:none; padding:0 20px; border-radius:10px; font-weight:bold;">Ø¥Ø±Ø³Ø§Ù„</button>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();
        let currentBot = null;
        let explainMode = false;
        let selectedBotForDetail = null;

        // Bot Data Database
        const botData = {
            'ØµÙŠØ§Ø¯': {
                slogan: "Ø³Ù‡Ù…Ùƒ ÙÙŠ Ø§Ù„Ù…Ø±Ù…Ù‰ ğŸ¹",
                strategyTitle: "Momentum Breakout (Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„Ø²Ø®Ù…)",
                scientificDesc: "ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ§Øª 'Relative Strength Index' Ù…Ø¹ Ø¯Ù…Ø¬ Ø£Ø­Ø¬Ø§Ù… Ø§Ù„ØªØ¯Ø§ÙˆÙ„ (Volume Weighted Analysis) Ù„Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø£Ø³Ù‡Ù… Ø§Ù„ØªÙŠ Ø¨Ø¯Ø£Øª ÙÙŠ Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚ Ù‚Ø¨Ù„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±."
            },
            'Ø±Ø²ÙŠÙ†': {
                slogan: "Ø§Ù„Ø¹Ù‚Ù„ Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ø§Ø·ÙØ© âš–ï¸",
                strategyTitle: "Value & Growth (Ø§Ù„Ù‚ÙŠÙ…Ø© ÙˆØ§Ù„Ù†Ù…Ùˆ)",
                scientificDesc: "ÙŠØ³ØªØ®Ø¯Ù… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ© (P/E Ratio, EPS Growth) Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¹Ø§Ø¯Ù„ Ù„Ù„Ø³Ù‡Ù…ØŒ ÙˆÙŠØ´ØªØ±ÙŠ ÙÙ‚Ø· Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø³ÙˆÙ‚ÙŠ Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¬ÙˆÙ‡Ø±ÙŠØ© (Intrinsic Value)."
            },
            'Ù…Ù‚Ø¯Ø§Ù…': {
                slogan: "Ù‚Ù„Ø¨ Ø§Ù„Ø£Ø³Ø¯ ğŸ¦",
                strategyTitle: "Volatility Scalping (Ø§Ù‚ØªÙ†Ø§Øµ Ø§Ù„ØªØ°Ø¨Ø°Ø¨)",
                scientificDesc: "ÙŠØ¹Ù…Ù„ ÙÙŠ Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ù…ØªØ·Ø±ÙØ©. ÙŠØ³ØªØ®Ø¯Ù… 'Bollinger Bands' Ùˆ 'ATR' Ù„ØªØ­Ø¯ÙŠØ¯ Ù†Ù‚Ø§Ø· Ø§Ù„Ø§Ù†Ø¹ÙƒØ§Ø³ Ø§Ù„Ø³Ø±ÙŠØ¹Ø© ÙÙŠ Ø§Ù„Ø£Ø³Ù‡Ù… Ø§Ù„Ø£ÙƒØ«Ø± ØªØ°Ø¨Ø°Ø¨Ø§Ù‹ Ø®Ù„Ø§Ù„ Ø§Ù„Ø¬Ù„Ø³Ø©."
            },
            'Ù‚Ù†Ø§Øµ': {
                slogan: "Ø·Ù„Ù‚Ø© ÙˆØ§Ø­Ø¯Ø© ØªÙƒÙÙŠ ğŸ¯",
                strategyTitle: "Supply & Demand Zones (Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„Ø·Ù„Ø¨)",
                scientificDesc: "ÙŠØ±Ø§Ù‚Ø¨ Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© Ø§Ù„Ù…Ø¤Ø³Ø³Ø§ØªÙŠØ© (Smart Money Concepts). Ù„Ø§ ÙŠØªØ¯Ø§ÙˆÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠØ§Ù‹ØŒ Ø¨Ù„ ÙŠØ¶Ø¹ Ø£ÙˆØ§Ù…Ø± Ù…Ø¹Ù„Ù‚Ø© ÙÙŠ Ù…Ù†Ø§Ø·Ù‚ 'Order Blocks' ÙˆÙŠÙ†ØªØ¸Ø± Ø§Ù„Ø³Ø¹Ø±."
            },
            'Ø¹ÙˆØ§Ø·Ù': {
                slogan: "Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø´Ø®ØµÙŠ ğŸ¤–",
                strategyTitle: "Natural Language Processing",
                scientificDesc: "Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ØªÙˆÙ„ÙŠØ¯ÙŠ Ù…Ø®ØµØµ Ù„Ù„Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©ØŒ ÙŠØ­Ù„Ù„ Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙƒ Ø¨Ø´ÙƒÙ„ ÙÙˆØ±ÙŠ."
            }
        };

        // View Switching
        function switchView(viewName) {
            document.querySelectorAll('.view-section').forEach(el => {
                el.classList.remove('active');
                setTimeout(() => {
                    if (!el.classList.contains('active')) el.style.display = 'none';
                }, 500);
            });
            const target = document.getElementById('view-' + viewName);
            target.style.display = 'block';
            setTimeout(() => target.classList.add('active'), 50);
        }

        // --- NEW: Bot Details Logic ---
        function showBotDetails(botName, returnVal) {
            selectedBotForDetail = botName;
            const data = botData[botName] || { slogan: '', strategyTitle: 'General Strategy', scientificDesc: '...' };

            // Populate Detials
            document.getElementById('detail-name').innerText = `Ø±ÙŠØ¨ÙˆØª ${botName}`;
            document.getElementById('detail-avatar').innerText = botName[0];

            // Handle return val display
            if (returnVal > 0) {
                document.getElementById('detail-return').innerText = `+${returnVal}%`;
                document.getElementById('detail-return').style.color = 'var(--accent-green)';
            } else {
                document.getElementById('detail-return').innerText = `--`;
                document.getElementById('detail-return').style.color = 'var(--text-muted)';
            }

            // Inject Slogan
            const sloganContainer = document.getElementById('detail-slogan');
            if (sloganContainer) sloganContainer.innerText = data.slogan;
            else {
                // If element doesn't exist yet (first run), creates it
                const header = document.querySelector('.detail-header');
                const slg = document.createElement('div');
                slg.id = 'detail-slogan';
                slg.style.color = 'var(--accent-gold)';
                slg.style.fontStyle = 'italic';
                slg.style.marginBottom = '10px';
                slg.innerText = data.slogan;
                header.insertBefore(slg, document.getElementById('detail-return'));
            }

            // Inject Scientific Strategy Box
            const stratContainer = document.getElementById('detail-strategy-box');
            console.log("Strat data: ", data);
            const stratHTML = `
                <div style="background:rgba(255,255,255,0.05); padding:15px; border-radius:12px; margin:20px; border:1px solid var(--border-color); text-align:right;">
                    <div style="display:flex; align-items:center; gap:10px; margin-bottom:10px; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:10px;">
                        <i data-lucide="cpu" style="color:var(--accent-gold);"></i>
                        <span style="font-weight:bold; color:white; font-size:0.9rem;">${data.strategyTitle}</span>
                    </div>
                    <p style="font-size:0.8rem; color:#ccc; line-height:1.6; margin:0;">
                        ${data.scientificDesc}
                    </p>
                </div>
            `;

            if (stratContainer) {
                stratContainer.innerHTML = stratHTML;
            } else {
                const newDiv = document.createElement('div');
                newDiv.id = 'detail-strategy-box';
                newDiv.innerHTML = stratHTML;
                const parent = document.querySelector('#view-bot-detail');
                // Insert after header
                parent.insertBefore(newDiv, document.querySelector('.section-header'));
                lucide.createIcons();
            }

            // Mock Proof List
            const list = document.getElementById('proof-list');
            list.innerHTML = `
                <div class="proof-item proof-win">
                    <div>
                        <div style="font-weight:bold;">Ø´Ø±Ø§Ø¡ Ø£Ø±Ø§Ù…ÙƒÙˆ (ARAMCO)</div>
                        <div style="color:#888; font-size:0.75rem;">Ø§Ù„Ø³Ø¨Ø¨: Ø§Ø®ØªØ±Ø§Ù‚ Ù…Ù‚Ø§ÙˆÙ…Ø© Ù‚ÙˆÙŠØ© + Ø£Ø®Ø¨Ø§Ø± Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©</div>
                    </div>
                    <div style="text-align:left;">
                        <div style="color:var(--accent-green);">+2.5%</div>
                        <div style="font-size:0.7rem;">Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</div>
                    </div>
                </div>
                <div class="proof-item proof-loss">
                    <div>
                        <div style="font-weight:bold;">ÙˆÙ‚Ù Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ</div>
                        <div style="color:#888; font-size:0.75rem;">Ø§Ù„Ø³Ø¨Ø¨: Ù‡Ø¨ÙˆØ· ÙØ¬Ø§Ø¦ÙŠ Ù„Ù„Ø³ÙˆÙ‚</div>
                    </div>
                    <div style="text-align:left;">
                        <div style="color:var(--accent-red);">-0.8%</div>
                        <div style="font-size:0.7rem;">Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</div>
                    </div>
                </div>
                <div class="proof-item proof-win">
                    <div>
                        <div style="font-weight:bold;">Ø¨ÙŠØ¹ Ø³Ø§Ø¨Ù‚ (SABIC)</div>
                        <div style="color:#888; font-size:0.75rem;">Ø§Ù„Ø³Ø¨Ø¨: Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù‡Ø¯Ù Ø§Ù„Ø³Ø¹Ø±ÙŠ</div>
                    </div>
                    <div style="text-align:left;">
                        <div style="color:var(--accent-green);">+1.2%</div>
                        <div style="font-size:0.7rem;">Ø§Ù„Ø®Ù…ÙŠØ³</div>
                    </div>
                </div>
            `;

            switchView('bot-detail');
            lucide.createIcons();
        }

        function confirmSubscribe() {
            if (!selectedBotForDetail) return;
            subscribe(selectedBotForDetail);
        }

        function subscribe(botName) {
            alert(`ØªÙ… Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø¨Ù†Ø¬Ø§Ø­ Ù…Ø¹ ${botName}! ğŸš€`);
            currentBot = botName;

            document.getElementById('dash-avatar').innerText = botName[0];
            document.getElementById('dash-status').innerText = `Ù…ØªØµÙ„ Ø¨Ù€ ${botName}`;
            document.querySelector('.fab-chat span').innerText = `Ø§Ø³Ø£Ù„ ${botName}`;

            switchView('dashboard');
            loadStrategy(botName);

            toggleExplain();
            setTimeout(() => {
                showInsight("Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© Ø§Ù„Ø¯Ø§Ø®Ù„Ø© Ø§Ù„Ø¢Ù†...");
            }, 1000);
        }

        function toggleExplain() {
            explainMode = !explainMode;
            const btn = document.getElementById('explain-toggle');
            if (explainMode) {
                btn.style.color = 'var(--accent-gold)';
                // alert("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø´Ø±Ø­");
                startSimulation();
            } else {
                btn.style.color = 'var(--text-muted)';
            }
        }

        function showInsight(text) {
            const container = document.getElementById('insight-container');
            const bubble = document.createElement('div');
            bubble.className = 'insight-bubble';
            bubble.innerHTML = `
                <div style="color:var(--accent-gold);"><i data-lucide="info"></i></div>
                <div style="font-size:0.85rem; color:white; line-height:1.4;">${text}</div>
            `;
            container.appendChild(bubble);
            lucide.createIcons();

            setTimeout(() => {
                bubble.style.opacity = '0';
                bubble.style.top = '-100px';
                setTimeout(() => bubble.remove(), 500);
            }, 6000);
        }

        function startSimulation() {
            if (!explainMode) return;
            setTimeout(() => {
                if (explainMode) showInsight(`ØªØ­Ù„ÙŠÙ„: Ù„Ø§Ø­Ø¸Øª Ø³ÙŠÙˆÙ„Ø© Ø¹Ø§Ù„ÙŠØ© ÙÙŠ Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø¨Ù†ÙˆÙƒ.`);
                if (explainMode) startSimulation();
            }, 15000);
        }

        async function loadStrategy(name) {
            const container = document.getElementById('content-area');
            container.innerHTML = '<div style="text-align:center; padding:20px; color:#aaa;"> Ø¬Ø§Ø±Ù Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>';
            try {
                const res = await fetch(`/api/portfolio/${encodeURIComponent(name)}`);
                const data = await res.json();
                document.getElementById('cash-display').innerText = data.cash.toFixed(2) + " SAR";

                if (data.history && data.history.length > 0) {
                    container.innerHTML = data.history.slice().reverse().map(t => {
                        return `
                        <div class="trx-item ${t.action === 'BUY' ? 'buy' : 'sell'}">
                            <div class="trx-details" style="flex-direction:column; gap:5px; width:100%;">
                                <div style="display:flex; justify-content:space-between;">
                                    <span class="strategy-tag ${t.action === 'BUY' ? 'green' : 'red'}">${t.action}</span>
                                    <span class="symbol-text">${t.symbol}</span>
                                    <span class="trx-price">${t.price.toFixed(2)}</span>
                                </div>
                                <div style="font-size:0.85rem; color:#ccc; display:flex; align-items:center; gap:5px;">
                                    <i data-lucide="cpu" style="width:12px;"></i> ${t.reason}
                                </div>
                            </div>
                        </div>
                        `;
                    }).join('');
                    lucide.createIcons();
                } else {
                    container.innerHTML = '<div style="text-align:center; padding:20px; color:#666;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙ‚Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹.</div>';
                }
            } catch (e) { console.error(e); }
        }

        function openChat() { document.getElementById('chat-modal').style.display = 'flex'; }
        async function sendMessage() {
            const inp = document.getElementById('chat-input');
            const txt = inp.value;
            if (!txt) return;
            const hist = document.getElementById('chat-history');
            hist.innerHTML += `<div style="text-align:right; margin-bottom:10px;"><span style="background:#334155; padding:8px 12px; border-radius:15px 15px 0 15px; display:inline-block;">${txt}</span></div>`;
            inp.value = '';
            try {
                const res = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ persona: currentBot || 'General', message: txt })
                });
                const d = await res.json();
                hist.innerHTML += `<div style="text-align:left; margin-bottom:10px;"><span style="background:var(--accent-green); color:black; padding:8px 12px; border-radius:15px 15px 15px 0; display:inline-block;">${d.response}</span></div>`;
            } catch (e) { }
        }
    </script>
</body>

</html>